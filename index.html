<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wolfie Dine</title>
    <meta name="description" content="Daily menus, hours, and live updates in a clean, fast view. Check what‚Äôs open, spot something tasty, and decide where to eat‚Äîquickly.">
    <link rel="canonical" href="https://www.wolfiedine.com/">
    <link rel="icon" href="/favicon.ico?v=20260123" sizes="any">
    <link rel="icon" type="image/png" sizes="16x16" href="/wolfiedine_icon_16.png?v=20260123">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=20260123">
    <link rel="icon" type="image/png" sizes="48x48" href="/wolfiedine_icon_48.png?v=20260123">
    <link rel="icon" type="image/png" sizes="192x192" href="/wolfiedine_icon_192.png?v=20260123">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background:   linear-gradient(135deg, #ffcdd2 0%, #ffebee 100%);
            min-height: 100vh;
            color: #333;
        }

        header {
            background: linear-gradient(135deg, #b71c1c 0%, #c62828 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: sticky;
            top:  0;
            z-index: 1000;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
        }

        .header-left {
            flex: 0 1 auto;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: -1px;
            margin: 0;
        }

        .tagline {
            font-size:   0.9rem;
            opacity: 0.9;
            font-weight: 300;
            margin-top: 0.25rem;
        }

        .clock-container {
            flex: 0 0 auto;
            text-align: right;
        }

        .clock-time {
            font-size: 1.8rem;
            font-weight:   700;
            margin:  0;
        }

        .clock-date {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-top: 0.15rem;
        }

        nav {
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 80px;
            z-index:   999;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            color: #c62828;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            text-decoration: none;
            display: inline-block;
        }

        .nav-btn::after {
            content: '';
            position: absolute;
            bottom:   0;
            left:  0;
            width: 0;
            height: 3px;
            background: #c62828;
            transition:   width 0.3s ease;
        }

        .nav-btn:hover::after,
        .nav-btn.active::after {
            width:   100%;
        }

        .nav-btn:hover {
            color: #b71c1c;
        }

        main {
            max-width: 1400px;
            margin:   2rem auto;
            padding: 0 2rem 2rem;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .meal-selector {
            text-align: center;
            margin-bottom: 2rem;
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity:   0;
                transform: translateY(20px);
            }
            to {
                opacity:   1;
                transform: translateY(0);
            }
        }

        .meal-selector h2 {
            color: #fff;
            margin-bottom: 1rem;
            font-size: 1.8rem;
        }

        .meal-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .meal-btn {
            padding: 0.75rem 2rem;
            border: 2px solid #fff;
            background: white;
            color: #c62828;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .meal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 255, 255, 0.3);
        }

        .meal-btn.active {
            background: #b71c1c;
            color: white;
            border-color: #b71c1c;
            transform: scale(1.05);
        }

        .dining-halls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.2rem;
            margin-top:  1.5rem;
        }

        .dining-hall {
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dining-hall:hover {
            transform: translateY(-4px);
            box-shadow:   0 6px 16px rgba(0, 0, 0, 0.15);
        }

        .hall-header {
            background: linear-gradient(135deg, #c62828 0%, #d32f2f 100%);
            color: white;
            padding: 1rem;
            text-align: center;
        }

        .hall-header h3 {
            font-size:   1.4rem;
            margin-bottom:   0.4rem;
        }

        .hall-status {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.4rem 0.8rem;
            border-radius: 16px;
            font-size:   0.8rem;
            font-weight:   600;
        }

        .menu-content {
            padding: 1rem;
            max-height: 420px;
            overflow-y:   auto;
        }

        .menu-content::-webkit-scrollbar {
            width: 6px;
        }

        .menu-content::-webkit-scrollbar-track {
            background:   #f1f1f1;
            border-radius: 10px;
        }

        .menu-content::-webkit-scrollbar-thumb {
            background:   #c62828;
            border-radius: 10px;
        }

        .menu-content::-webkit-scrollbar-thumb:hover {
            background:  #b71c1c;
        }

        .menu-category {
            margin-bottom: 1.2rem;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity:  0;
                transform:   translateX(-20px);
            }
            to {
                opacity: 1;
                transform:  translateX(0);
            }
        }

        .category-title {
            color: #c62828;
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            padding-bottom: 0.4rem;
            padding-left: 1rem;
            border-bottom: 2px solid #ffebee;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .category-icon {
            font-size: 1.2rem;
        }

        .menu-items {
            list-style: none;
            padding-left: 1rem;
        }

        .menu-item {
            padding: 0.4rem 0;
            padding-left: 0.8rem;
            border-left: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95rem;
        }

        
        .menu-item-link{
            display:flex;
            justify-content:space-between;
            align-items:center;
            width:100%;
            color:inherit;
            text-decoration:none;
        }

        .menu-item-link:focus-visible{
            outline:none;
            box-shadow:0 0 0 4px rgba(198,40,40,.18);
            border-radius:8px;
        }

.menu-item:hover {
            border-left-color: #c62828;
            background: #ffebee;
            padding-left: 1.2rem;
        }

        .item-price {
            color: #c62828;
            font-weight: 600;
            font-size: 0.9rem;
            margin-left: 0.75rem;
        }

        .no-menu {
            text-align: center;
            padding: 2.5rem;
            color: #666;
            font-style: italic;
        }

        .loading-message {
            text-align: center;
            padding: 2rem;
            color: #666;
            font-style: italic;
        }

        .last-updated {
            text-align: center;
            color: #888;
            font-size: 0.8rem;
            margin-top:   0.8rem;
            padding-top:  0.6rem;
            border-top:   1px solid #ffebee;
            font-style: italic;
        }

        .about-content {
            background: white;
            border-radius: 12px;
            padding: 3rem;
            max-width: 800px;
            margin: 2rem auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.6s ease-out;
            line-height: 1.8;
        }

        .about-content h2 {
            color: #c62828;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .about-content p {
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            color: #333;
        }

        .about-content a {
            color: #c62828;
            text-decoration:   underline;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .about-content a:hover {
            color: #b71c1c;
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: #fff;
            margin-top: 3rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .header-container {
                flex-direction: column;
                text-align: center;
                gap: 0.75rem;
            }

            .clock-container {
                text-align: center;
            }

            .clock-time {
                font-size: 1.5rem;
            }

            .dining-halls {
                grid-template-columns: 1fr;
            }

            .nav-container {
                gap: 0.5rem;
            }

            .nav-btn {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }

            .meal-buttons {
                flex-direction: column;
                align-items: stretch;
                max-width: 300px;
                margin: 0 auto;
            }

            .header-container,
            .nav-container,
            main {
                padding: 0 1rem;
            }

            .about-content {
                padding: 2rem 1.5rem;
            }

            .menu-content {
                max-height: 350px;
            }

            .category-title {
                padding-left: 0.5rem;
            }

            .menu-items {
                padding-left: 0.5rem;
            }
        }

        @media (max-width:   576px) {
            .dining-halls {
                grid-template-columns: 1fr;
            }
            
            .hall-header h3 {
                font-size: 1.3rem;
            }

            .category-title {
                font-size: 1rem;
            }

            .about-content h2 {
                font-size:   2rem;
            }
        }

        @media (min-width: 1200px) {
            .dining-halls {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width:   1600px) {
            .dining-halls {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .meal-selector{
          background:#fff;
          border-radius: 18px;
          padding:2.2rem 2rem;
          max-width: 860px;
          margin:1.4rem auto 2rem;
          border:1px solid rgba(0,0,0,.06);
          box-shadow:0 10px 24px rgba(0,0,0,.10);
        }

        .meal-selector h2{
          color:#9b1111;     
          font-size:2rem;
          font-weight:750;
          letter-spacing: -.02em;
          margin:0 0 1.3rem;
        }

        .meal-buttons{
          display:flex;
          justify-content:center;
          gap:1.4rem;
          flex-wrap:wrap;
        }

        .meal-btn{
          border:1px solid rgba(0,0,0,.06);
          background:#f2f3f5;
          color:#30343a;
          padding:.82rem 2.2rem;
          border-radius:9999px;
          cursor:pointer;
          transition:background .16s ease, box-shadow .16s ease, transform .16s ease, color .16s ease, border-color .16s ease;
          box-shadow:none;

          display:flex;
          flex-direction:column;
          align-items:center;
          gap:.35rem;
          text-align:center;
          line-height:1.05;
          min-width: 220px;
        }

        .meal-label{
          font-size:1rem;
          font-weight:650;
        }

        .meal-time{
          font-size:0.82rem;
          font-weight:600;
          opacity:.75;
          line-height:1.2;
        }

        .meal-btn.active .meal-time{
          opacity:.9;
        }
.meal-btn:hover{
          background:#eceef1;
          transform:translateY(-1px);
        }

        .meal-btn.active{
          background:#b11212;   
          border-color: rgba(177,18,18,.18);
          color:#fff;
          box-shadow:0 10px 18px rgba(177,18,18,.22);
          transform:none;
        }

        .meal-btn:focus-visible{
          outline: none;
          box-shadow: 0 0 0 4px rgba(177,18,18,.18);
        }

        @media (max-width:768px){
          .meal-selector{ padding:1.8rem 1.2rem; }
          .meal-btn{ width:100%; }
        }
    
        /* Meal period buttons: label + time, keep a clean one-row layout on desktop */
        .meal-buttons {
            gap: 1.25rem;
        }
        .meal-buttons.weekday {
            flex-wrap: nowrap;
        }
        .meal-option {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .meal-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            line-height: 1.05;
            padding: .85rem 1.35rem;
            min-width: 150px;
        }
        .meal-btn .meal-label {
            font-size: 1.05rem;
            font-weight: 750;
        }
        .meal-btn .meal-time {
            margin-top: 0.3rem;
            font-size: 0.82rem;
            font-weight: 650;
            opacity: 0.85;
        }
        .meal-btn.active .meal-time {
            opacity: 0.95;
        }
        @media (max-width: 900px) {
            .meal-buttons.weekday {
                flex-wrap: wrap;
            }
            .meal-btn {
                min-width: 140px;
            }
        }

    </style>
    <!-- Cloudflare Web Analytics -->
<script defer src="https://static.cloudflareinsights.com/beacon.min.js"
  data-cf-beacon='{"token": "b55eeac22b1c465d9a39541f96cbcdae"}'></script>
<!-- End Cloudflare Web Analytics -->

</head>
<body>
    <header>
        <div class="header-container">
            <div class="header-left">
                <h1>üê∫ Wolfie Dine</h1>
                <p class="tagline">Your campus dining companion</p>
            </div>
            <div class="clock-container">
                <div class="clock-time" id="clock-time">00:00:00</div>
                <div class="clock-date" id="clock-date">Loading...</div>
            </div>
        </div>
    </header>

    <nav>
        <div class="nav-container">
            <button class="nav-btn active" onclick="showPage('menu', this)">Menu</button>
            <button class="nav-btn" onclick="showPage('about', this)">About</button>
            <a class="nav-btn" href="https://docs.google.com/forms/d/e/1FAIpQLSfwXXeb2SHBLBE1TENjznsm8F5WlA5zCsay5n1cbmbJU2BTIQ/viewform?usp=sharing&ouid=114715764942658548801" target="_blank" rel="noopener noreferrer">Feedback</a>
        </div>
    </nav>

    <main>
        <div id="menu-page" class="page active">
            <div class="meal-selector">
                <h2>Select Meal Period</h2>
                <div class="meal-buttons" id="meal-buttons"></div>
            </div>
<div class="dining-halls" id="dining-halls-container">
            </div>
        </div>

        <div id="about-page" class="page">
            <div class="about-content">
                <h2>About Wolfie Dine</h2>
                <p>
                    Wolfie Dine is a menu aggregator for the Stony Brook University dining halls that lets students see all meal options in one place. 
                </p>
                <p>
                    Wolfie Dine was founded in January 2025 by Tina Yu [CC '26] and Chenhao Yu [CC '26].  It's maintained by current students and updates daily.
                </p>
                <p>
                    See the <a href="https://stonybrook.nutrislice.com" target="_blank" rel="noopener noreferrer">official Dining website</a> for hours updates, nutritional information, service alerts[...]
                </p>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2026 Wolfie Dine.   Bringing campus dining to your fingertips.</p>
    </footer>

    <script>
        const menuData = {
            'west-hall': {
                name: 'West Campus Dining Hall',
                breakfast: {
                    'Breakfast Classics': [
                        'Scrambled Eggs',
                        'Bacon',
                        'Sausage Links',
                        'Hash Browns',
                        'Pancakes',
                        'French Toast',
                        'Belgian Waffles'
                    ],
                    'Healthy Options': [
                        'Fresh Fruit Bowl',
                        'Greek Yogurt Parfait',
                        'Oatmeal Bar',
                        'Granola',
                        'Whole Grain Toast'
                    ],
                    'Beverages': [
                        'Coffee',
                        'Orange Juice',
                        'Apple Juice',
                        'Hot Tea',
                        'Milk'
                    ]
                },
                lunch: {
                    'Entrees': [
                        'Grilled Chicken Breast',
                        'Beef Tacos',
                        'Vegetarian Pasta Primavera',
                        'Baked Salmon',
                        'BBQ Pulled Pork Sandwich'
                    ],
                    'Sides': [
                        'Caesar Salad',
                        'French Fries',
                        'Steamed Broccoli',
                        'Rice Pilaf',
                        'Coleslaw'
                    ],
                    'Soups': [
                        'Tomato Soup',
                        'Chicken Noodle Soup'
                    ],
                    'Desserts': [
                        'Chocolate Chip Cookies',
                        'Fresh Fruit',
                        'Ice Cream'
                    ]
                },
                dinner: {
                    'Entrees': [
                        'Prime Rib',
                        'Herb Roasted Chicken',
                        'Shrimp Scampi',
                        'Vegetable Stir Fry',
                        'Meatloaf',
                        'Baked Ziti'
                    ],
                    'Sides': [
                        'Mashed Potatoes',
                        'Green Beans',
                        'Garden Salad',
                        'Garlic Bread',
                        'Roasted Vegetables'
                    ],
                    'Soups': [
                        'French Onion Soup',
                        'Minestrone'
                    ],
                    'Desserts': [
                        'Cheesecake',
                        'Brownies',
                        'Apple Pie',
                        'Fruit Cobbler'
                    ]
                }
            },
            'east-hall': {
                name:   'East Campus Dining Hall',
                breakfast: {
                    'Hot Breakfast':   [
                        'Eggs Benedict',
                        'Omelet Station',
                        'Turkey Bacon',
                        'Breakfast Burrito',
                        'Cinnamon Rolls',
                        'Bagels with Cream Cheese'
                    ],
                    'Continental':  [
                        'Assorted Pastries',
                        'Fresh Berries',
                        'Yogurt Station',
                        'Cereal Bar',
                        'Toast & Jam'
                    ],
                    'Beverages': [
                        'Espresso Bar',
                        'Fresh Squeezed Juice',
                        'Smoothies',
                        'Herbal Tea',
                        'Chocolate Milk'
                    ]
                },
                lunch: {
                    'Entrees': [
                        'Buffalo Chicken Wrap',
                        'Veggie Burger',
                        'Fish Tacos',
                        'Chicken Teriyaki',
                        'Margherita Pizza'
                    ],
                    'Sides': [
                        'Sweet Potato Fries',
                        'Mixed Green Salad',
                        'Corn on the Cob',
                        'Quinoa Salad',
                        'Onion Rings'
                    ],
                    'Soups':   [
                        'Butternut Squash Soup',
                        'Vegetable Soup'
                    ],
                    'Desserts': [
                        'Cupcakes',
                        'Jello',
                        'Seasonal Fruit'
                    ]
                },
                dinner: {
                    'Entrees': [
                        'Steak Tips',
                        'Lemon Garlic Tilapia',
                        'Chicken Parmesan',
                        'Tofu Pad Thai',
                        'Beef Stroganoff',
                        'Fajita Bar'
                    ],
                    'Sides': [
                        'Loaded Baked Potato',
                        'Asparagus',
                        'Caprese Salad',
                        'Mac and Cheese',
                        'Saut√©ed Spinach'
                    ],
                    'Soups': [
                        'Loaded Baked Potato Soup',
                        'Clam Chowder'
                    ],
                    'Desserts': [
                        'Tiramisu',
                        'Cookies',
                        'Carrot Cake',
                        'Gelato'
                    ]
                }
            },
            'dental-cafe': {
                name: 'Dental Caf√©',
                isDynamic: true
            }
        };



        // Late Night uses the same menu as Dinner for static halls
        menuData['west-hall'].latenight = menuData['west-hall'].dinner;
        menuData['east-hall'].latenight = menuData['east-hall'].dinner;

        let dentalCafeData = null;

        const categoryIcons = {
            'Breakfast Classics': 'üç≥',
            'Hot Breakfast': 'üç≥',
            'Healthy Options': 'ü•ó',
            'Continental': 'ü•ê',
            'Beverages': '‚òï',
            'Entrees': 'üçΩÔ∏è',
            'Sides': 'ü•ò',
            'Soups':   'üç≤',
            'Desserts': 'üç∞',
            'All Items': 'üç¥'
        };

        let currentMeal = 'breakfast';

        
        function getSBUTimeParts() {
            // Use SBU local time (America/New_York) so the default meal matches campus hours
            try {
                const now = new Date();
                const parts = new Intl.DateTimeFormat('en-US', {
                    timeZone: 'America/New_York',
                    hour12: false,
                    weekday: 'short',
                    hour: '2-digit',
                    minute: '2-digit'
                }).formatToParts(now);

                const get = (t) => {
                    const p = parts.find(x => x.type === t);
                    return p ? p.value : null;
                };

                const hour = parseInt(get('hour') || '0', 10);
                const minute = parseInt(get('minute') || '0', 10);
                const weekday = get('weekday') || '';
                return { hour, minute, weekday };
            } catch (e) {
                // Fallback to user's local time if Intl timezone is unavailable
                const now = new Date();
                const hour = now.getHours();
                const minute = now.getMinutes();
                const weekday = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][now.getDay()];
                return { hour, minute, weekday };
            }
        }

        function pickInitialMeal() {
            const now = new Date();
            const day = now.getDay(); // 0 Sun ... 6 Sat
            const minutes = now.getHours() * 60 + now.getMinutes();

            const isWeekend = (day === 0 || day === 6);

            const schedule = isWeekend ? [
                { key: 'lunch', label: 'Brunch', time: '9am‚Äì3:59pm', start: 9 * 60, end: 16 * 60 },
                { key: 'dinner', label: 'Dinner', time: '4pm‚Äì11pm', start: 16 * 60, end: 23 * 60 }
            ] : [
                { key: 'breakfast', label: 'Breakfast', time: '7:30‚Äì10:59am', start: 7 * 60 + 30, end: 11 * 60 },
                { key: 'lunch', label: 'Lunch', time: '11am‚Äì3:59pm', start: 11 * 60, end: 16 * 60 },
                { key: 'dinner', label: 'Dinner', time: '4pm‚Äì9:59pm', start: 16 * 60, end: 22 * 60 },
                { key: 'late-night', label: 'Late Night', time: '10pm‚Äì12am', start: 22 * 60, end: 24 * 60 }
            ];

            // If we're inside a window, use that.
            for (const slot of schedule) {
                if (minutes >= slot.start && minutes < slot.end) return slot.key;
            }

            // Otherwise pick the next upcoming window today; if none, fall back to first slot.
            for (const slot of schedule) {
                if (minutes < slot.start) return slot.key;
            }
            return schedule[0].key;
        }


        function applyMealSchedule() {
            const now = new Date();
            const day = now.getDay(); // 0 Sun ... 6 Sat
            const isWeekend = (day === 0 || day === 6);

            const schedule = isWeekend ? [
                { key: 'lunch', label: 'Brunch', time: '9am‚Äì3:59pm' },
                { key: 'dinner', label: 'Dinner', time: '4pm‚Äì11pm' }
            ] : [
                { key: 'breakfast', label: 'Breakfast', time: '7:30‚Äì10:59am' },
                { key: 'lunch', label: 'Lunch', time: '11am‚Äì3:59pm' },
                { key: 'dinner', label: 'Dinner', time: '4pm‚Äì9:59pm' },
                { key: 'late-night', label: 'Late Night', time: '10pm‚Äì12am' }
            ];

            const buttonsWrap = document.getElementById('meal-buttons');
            if (!buttonsWrap) return;

            // Layout hint for CSS: weekday wants a single row when space allows.
            buttonsWrap.classList.toggle('weekday', !isWeekend);

            // Rebuild buttons (keeps styling + active class logic elsewhere)
            buttonsWrap.innerHTML = schedule.map(slot => `
                <div class="meal-option">
                    <button class="meal-btn" data-meal="${slot.key}">
                        <span class="meal-label">${slot.label}</span>
                        <span class="meal-time">${slot.time}</span>
                    </button>
                </div>
            `).join('');

            // Attach click handlers
            buttonsWrap.querySelectorAll('.meal-btn').forEach(btn => {
                btn.addEventListener('click', () => changeMeal(btn.dataset.meal));
            });
        }

function setInitialMealUI(initialMeal) {
            currentMeal = initialMeal;

            document.querySelectorAll('.meal-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            const chosenBtn = document.querySelector(`[data-meal="${initialMeal}"]`);
            if (chosenBtn && chosenBtn.style.display !== 'none') {
                chosenBtn.classList.add('active');
            } else {
                // Fallback when the initially-chosen meal is hidden (e.g., Weekend)
                const fallbackBtn = document.querySelector('[data-meal="lunch"]');
                if (fallbackBtn) {
                    currentMeal = 'lunch';
                    fallbackBtn.classList.add('active');
                }
            }

            renderDiningHalls();
        }

async function loadDentalCafeData() {
            const controller = new AbortController();
            const timeout = setTimeout(() => controller.abort(), 9000); // avoid infinite loading
            try {
                const response = await fetch('dental_cafe.json?ts=' + Date.now(), {
                    cache: 'no-store',
                    signal: controller.signal
                });
                if (!response.ok) throw new Error('Could not load menu');
                dentalCafeData = await response.json();
            } catch (error) {
                console.error('Error loading Dental Cafe data:', error);
                dentalCafeData = {
                    status: 'fetch_error',
                    message: 'Menu data unavailable (refresh or try again later)',
                    menu: [],
                    updated_at: ''
                };
            } finally {
                clearTimeout(timeout);
                // Ensure we re-render to replace the loading state.
                renderDiningHalls();
            }
        }

        function updateClock() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const timeString = `${hours}:${minutes}:${seconds}`;
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            const dayOfWeek = days[now.getDay()];
            const month = months[now.getMonth()];
            const date = now.getDate();
            const year = now.getFullYear();
            const dateString = `${dayOfWeek}, ${month} ${date}, ${year}`;
            document.getElementById('clock-time').textContent = timeString;
            document.getElementById('clock-date').textContent = dateString;
        }

        setInterval(updateClock, 1000);
        updateClock();

        function showPage(pageName, btn) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(`${pageName}-page`).classList.add('active');

            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if (btn) btn.classList.add('active');

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function capitalize(s) {
            return s ?  s.charAt(0).toUpperCase() + s.slice(1) : s;
        }

        
        function nutrisliceDentalCafeDayUrl(dateStr) {
            const base = "https://stonybrook.nutrislice.com/menu/sbu-eats-events/dental-cafe";
            if (!dateStr) return base;
            // Nutrislice menu pages commonly accept YYYY-MM-DD via the `day` query parameter.
            return `${base}?day=${encodeURIComponent(dateStr)}`;
        }

function renderDentalCafeContent() {
            if (dentalCafeData === null) {
                return '<div class="loading-message">Loading menu...</div>';
            }

            const status = dentalCafeData.status || '';
            const message = dentalCafeData.message || '';
            const menu = Array.isArray(dentalCafeData.menu) ? dentalCafeData.menu : [];

            const updated = dentalCafeData.updated_at
                ? `<div class="last-updated">Last updated: ${dentalCafeData.updated_at}</div>`
                : '';

            // If empty menu, show message (weekend_no_menu / no_data_today / fetch_error)
            if (menu.length === 0) {
                const text = message || 'No menu data available.';
                const style = status === 'fetch_error' ? 'style="color:#b71c1c"' : '';
                return `<div class="no-menu" ${style}>${text}</div>${updated}`;
            }

            const items = menu.map(item => {
                const dateStr = (dentalCafeData && dentalCafeData.date)
                    ? dentalCafeData.date
                    : (dentalCafeData && dentalCafeData.updated_at ? dentalCafeData.updated_at.split(' ')[0] : null);

                const href = nutrisliceDentalCafeDayUrl(dateStr);

                return `
                    <li class="menu-item">
                        <a class="menu-item-link" href="${href}" target="_blank" rel="noopener noreferrer">
                            <span>${item.name}</span>
                        </a>
                    </li>
                `;
            }).join("");

            return `
                <div class="menu-category">
                    <h4 class="category-title">
                        <span class="category-icon">üç¥</span>
                        Today's Menu
                    </h4>
                    <ul class="menu-items">${items}</ul>
                </div>
                ${updated}
            `;
        }

        function renderStaticHallMenu(menu) {
            if (! menu || Object.keys(menu).length === 0) {
                return '<div class="no-menu">No menu available for this meal period</div>';
            }

            return Object.keys(menu).map(category => {
                const icon = categoryIcons[category] || 'üç¥';
                const items = menu[category]
                    .map(item => `<li class="menu-item"><span>${item}</span></li>`)
                    .join('');

                return `
                    <div class="menu-category">
                        <h4 class="category-title">
                            <span class="category-icon">${icon}</span>
                            ${category}
                        </h4>
                        <ul class="menu-items">${items}</ul>
                    </div>
                `;
            }).join('');
        }

        function renderDiningHalls() {
            const container = document.getElementById('dining-halls-container');
            container.innerHTML = '';

            Object.keys(menuData).forEach(hallId => {
                const hall = menuData[hallId];
                const hallDiv = document.createElement('div');
                hallDiv.className = 'dining-hall';

                let menuContent;
                if (hall.isDynamic) {
                    menuContent = renderDentalCafeContent();
                } else {
                    const menu = hall[currentMeal];
                    menuContent = renderStaticHallMenu(menu);
                }

                hallDiv.innerHTML = `
                    <div class="hall-header">
                        <h3>${hall.name}</h3>
                        <span class="hall-status">Open</span>
                    </div>
                    <div class="menu-content">
                        ${menuContent}
                    </div>
                `;

                container.appendChild(hallDiv);
            });
        }

        function changeMeal(meal) {
            currentMeal = meal;

            document.querySelectorAll('.meal-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-meal="${meal}"]`).classList.add('active');

            renderDiningHalls();
        }

        applyMealSchedule();
        setInitialMealUI(pickInitialMeal());
        loadDentalCafeData();
        renderDiningHalls();
    </script>
</body>
</html>
